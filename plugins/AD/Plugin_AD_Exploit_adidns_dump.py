import argparse
from copy import copy

from plugins.AD import PluginAdExploitBase
from utils.consts import AllPluginTypes


class PluginADAdiDNSDump(PluginAdExploitBase):
    """
    AdiDNSDump信息探测
    """

    display = "AdiDNSDump信息探测"
    alias = "adi_dns_dmp"
    p_type = AllPluginTypes.Exploit

    def __init__(self):
        super().__init__()

    def reg_argument(self, parser: argparse.ArgumentParser):
        parser.description= "AdiDNSDump信息探测"
        parser.add_argument("--", help="", dest="")
        parser.add_argument("--", help="",
                            dest="")

    def run_script(self, args) -> dict:
        """
        脚本入口函数
        :return: bool
        """
        result = copy(self.result)
        # TODO
        return result